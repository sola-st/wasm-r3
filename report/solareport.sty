%  Original version: Sascha A. Stoeter <stoeter@iris.ethz.ch>, www.stoeter.com
%  Adapted for LST: Oliver Trachsel <oliver.trachsel /at/ inf.ethz.ch>
%  Adapted for SOLA: Michael Pradel, Nov 2014
%  Adapted for U Stuttgart: Michael Pradel, Nov 2019
%  Adapted for U Stuttgart: Michael Pradel, Sep 2020

\def\packagename{solathesis} \def\packagemessage{Thesis style of the
Software Lab, University of Stuttgart}
\def\fileversion{1.2} \def\filedate{2020/09/22}
\def\docdate{2020/09/22}

% ---- identification ---------------------------------------------------------
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{solareport}[\filedate\space v\fileversion\space \packagename]
\typeout{Package: `\packagename' v\fileversion\space <\filedate>}
\typeout{\packagemessage}

% ---- package loading --------------------------------------------------------
\RequirePackage{a4}
\RequirePackage{amsmath}
\RequirePackage{geometry}
\RequirePackage{fancyhdr}
\RequirePackage{graphicx}
\RequirePackage{setspace}
\RequirePackage{titlesec}
\RequirePackage{etoolbox}

% ---- main code --------------------------------------------------------------
\DeclareGraphicsExtensions{.pdf,.PDF,.png,.PNG,.jpg,.JPG}
\geometry{inner=2.5cm,outer=2cm,top=1.7cm,bottom=2cm,includehead,includefoot}
\onehalfspacing

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{2}

\numberwithin{equation}{section}  % (sec.number)

% Formatting of chapter titles
\titleformat{\chapter}[hang]{\huge\bf}{\thechapter}{1em}{}

% Avoid page headers on empty pages before new chapters
\def\cleardoublepage{\clearpage\if@twoside%
  \ifodd\c@page\else\hbox{}\thispagestyle{empty}\newpage%
  \if@twocolumn\hbox{}\newpage\fi\fi\fi}

% Set header format
\setlength{\headheight}{16pt}
\pagestyle{fancy}
\fancyhead{}
\fancyhead[LO,RE]{\nouppercase\leftmark }
\fancyhead[LE,RO]{\thepage} 
\fancyfoot{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\chaptermark}[1]{\markboth{\textsc{\thechapter. #1}}{}}
\renewcommand{\sectionmark}[1]{\markright{\textsc{\thesection. #1}}}

\bibliographystyle{abbrv}

\def\thesistype{}
\def\thesisauthor{}
\def\thesisadvisor{}

\newcommand{\thesistitlepage}[1]{
\thispagestyle{empty}
\begin{spacing}{1}
\begin{center}
Software Lab\\
Institute of Software Engineering\\
University of Stuttgart\\
Universit\"atsstra{\ss}e 38, 
70569 Stuttgart\\

\vspace{12em}

\begin{minipage}{20em}
\begin{center}
\begin{spacing}{1.8}
\thesistype{} Thesis

\vspace{1em}
{ \LARGE \textbf{#1}}

\vspace{1em}
\thesisauthor{}
\end{spacing}
\end{center}
\end{minipage}

\vfill

{
\renewcommand{\arraystretch}{1.5}
\begin{tabular}{@{}p{10em}p{20em}@{}}
\textbf{Course of study:} & \studyprogram{} \\

\textbf{Examiner:} & Prof.\ Dr.\ Michael Pradel \\ 

\textbf{Supervisor:} &

\ifdefempty{\thesisadvisor}{
Prof.\ Dr.\ Michael Pradel
}{
\thesisadvisor{}
}
 \\ 

\textbf{Started:} & \thesisstartdate{} \\ 

\textbf{Completed:} & \thesisenddate{} \\
\end{tabular}
}

\vfill

\begin{tabular*}{\linewidth}{l@{\extracolsep{\fill}}r}
\includegraphics[height=13mm]{figures/UStuttLogo} & \includegraphics[height=13mm]{figures/SOLALogo}
\end{tabular*}

%{\large }\\
%\vspace*{\stretch{1}}
%{\LARGE\bf #1}\\
%\vspace*{\stretch{1}}
%{\large\bf \thesisauthor{}}\\
%\vspace*{\stretch{3}}
%\ifdefempty{\thesisadvisor}{}{
%\thesisadvisor{}\\
%{\footnotesize Advising assistant}\\
%%\vspace*{1.5\lineheight}
%\vspace*{2em}
%}
%Prof.\ Dr.\ Michael Pradel\\
%Software Lab\\
%University of Stuttgart\\
%\vspace*{\stretch{2}}
%{\large #2}\\
%\vspace*{\stretch{2}}
%\begin{tabular*}{\linewidth}{l@{\extracolsep{\fill}}r}
%\includegraphics[height=13mm]{figures/UStuttLogo} & \includegraphics[height=13mm]{figures/SOLALogo}
%\end{tabular*}
\end{center}
\end{spacing}
}
